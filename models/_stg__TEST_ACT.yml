models:
  - name: first_layer_ACT
    columns:
      - name: ACCT_NO
        tests:
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "ACCT_NO is not null"
          - unique
          - dbt_expectations.expect_compound_columns_to_be_unique:
              column_list: ["ACCT_NO", "FIRM_NO"] 
      
      - name: FIRM_NO
        tests:
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "FIRM_NO is not null"
      #     - dbt_expectations.expect_compound_columns_to_be_unique:
      #         column_list: ["ACCT_NO", "FIRM_NO"]
     
      - name: ACCT_STATUS
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']

      - name: ACCT_TYPE_IND
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']

      # - name: SUB_NO
      #   tests:
      #     - dbt_expectations.expect_compound_columns_to_be_unique:
      #         column_list: ["FIRM_NO"]

      - name: INST_CODE
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "INST_CODE is not null"

      - name: INST_OVERRIDE_SW
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "INST_OVERRIDE_SW is not null"

      - name: PRIME_BROKER_CODE
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']

      - name: CASH_SI1
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "CASH_SI1 is not null"

      - name: CASH_SI2
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "CASH_SI2 is not null"

      - name: DIRECTOR_SW
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']

      - name: NON_CUSTOMER_SW
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['a','b','c']

